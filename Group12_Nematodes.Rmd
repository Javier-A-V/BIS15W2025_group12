---
title: "Group12_Nematodes"
output: html_document
---

```{r}
#install.packages("leaflet")
```


```{r}
library("tidyverse")
library("janitor")
library("naniar")
library("readxl")
library(shiny)
library(shinydashboard)
library(shinythemes)
library(fastmap)
library(leaflet)
```

```{r}
nematodes <- read.csv("data/dataset2.txt", header = TRUE, sep = "", stringsAsFactors = FALSE, fill = TRUE)
#this way cleans up the data nicely, can clean it up further and combine more data
```

```{r}
names(nematodes)
```

```{r}
treonis <- read.csv("data/Treonis.csv") %>% clean_names()

```

```{r}
soil <- read_excel("Soil_nematodes_all_data_final_Dryad.xlsx") %>% clean_names()
```


```{r} 
treonis_1 <- treonis %>%  #cleaning up the column names 
  rename_with(~str_replace(.x, "_identified", "")) 
 
```

```{r}
soil <- soil %>% 
  replace_with_na_all(condition = ~.x == "NaN") 
```

```{r}
treonis_2 <- treonis_1 %>% 
  pivot_longer(cols = 14:27, 
               names_to = "species", 
               values_to = "count")
```

```{r}
treonis_2 <- treonis_2 %>% 
  replace_with_na_all(condition = ~.x == 9999) 

```

```{r}
treonis_2 <- treonis_2 %>% 
  replace_with_na_all(condition = ~.x == "nd") 
```

```{r}
treonis_2 <- treonis_2 %>% #pivoted back because there were too many duplicates from the first pivot
  pivot_wider(names_from = "species", 
              values_from = "count")
```

```{r}
  write.csv(treonis_2, "data/treonis_2.csv", row.names = FALSE)
```



```{r}
names(soil)
```


```{r}
soil %>% 
  ggplot(aes(x=p_h, y=elevation))+
  geom_point()+
  geom_smooth(method = lm, se=F)
```

```{r}
library(shiny)

ui <- fluidPage(titlePanel("Nematodes with Soils App"),
                selectInput("x", 
                            "Select X Variable",
                            choices = c("p_h", "conductivity", "temperature"),
                            selected = "p_h"),
                selectInput("y", 
                            "Select Y Variable",
                            choices = c("p_h", "conductivity", "temperature"),
                            selected = "conductivity"),
                plotOutput("ggplot_map")
                
  
)

server <- function(input, output, session) {
  session$onSessionEnded(stopApp)
     
}

shinyApp(ui, server)
```

